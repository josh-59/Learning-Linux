---
layout: default
title: Finding Files
last-updated: July, 2020
---

<div id="nav_bar_2" class="nav">
    <ul>
        <li><a href="#introduction"> Introduction </a></li>
        <li><a href="#basename"> Pathnames and Basenames </a></li>
        <li><a href="#locate"> Locate </a></li>
        <li><a href="#find"> Find </a></li>
        <li><a href="#regex"> Regex </a></li>
        <li><a href="#grep"> Grep </a></li>
        <li><a href="#engineer-man"> Engineer Man</a></li>
        <li><a href="#references"> References </a></li>
    </ul>
</div>

<div id="introduction" class="content">
    <h1>Finding Files</h1>
    {% comment %}
    <h4> Oh where the hell is that damn thing </h4>
    <h4> <code>sudo find / -regex ".*[Ll]earn[ing].*[Ll]inux.*"</code> </h4>

      <div class="quote-ref">
        &mdash;Josh Timmons
      </div>
    {% endcomment %}
    <h4> Under Construction! </h4>

    <p>
        Finding files is a very common operation in Linux, and the tools
        available are powerful, but not new-user friendly.
        This paper will cover the most common file-finding utilities, and
        touch upon regex.  
    </p>
</div>

<div id="basename" class="content">
    <h2> Pathnames and Basenames</h2>
    <p>
        To start, we must make a clear distinction between a file's
        <em>pathname</em> and a file's <em>basename</em>, because
        our search tools will often make a distinction between these two.
    </p>

    <center><img style="width: 70%;" src="./assets/img/pathname-basename.png"></center>

    <p>
        Every file in the system has a pathname, which begins at root, <code>/</code>.
        This is also known as an <em>absolute filename</em>, and sometimes, a <em>wholename</em>.
        Each pathname denotes a unique point in the directory tree.
		</p>

    <p> The command <code>readlink</code> can report to us the pathname of an
        arbitrary file:

        <div class="code">
            $ cd /home/josh<br>
            $ readlink -f bin<br>
            /home/josh/bin
        </div>
    </p>

    <p>
        Every file in the system also has a basename.
        The command <code>basename</code> isolates this name for us:
        <div class="code">
            $ basename /home/josh/studies/merge.c<br>
            merge.c
        </div>
    </p>

    <p>
        Now, on to finding files!
    </p>
</div>

<div id="locate" class="content">
    <h2> Locate </h2>
    <p>
        Starting out, your best bet is the <code>locate</code> command:
	</p>

	<div class="code">
		$ locate <em>pattern</em>
	</div>

	<p>
    By default, <code>locate</code> matches <em>*pattern*</em> against the pathname of each file,
    using <a href="command-line-tutorial-introduction.html#globbing">shell globbing</a> to interpret the asterisks; essentially, 
    </p>

    <div class="code">
        $ locate <em>pattern</em>
    </div>

    <p>
        says, "Print out all absolute filenames containing the string <em>pattern</em>.
	</p>

    <p>
        For instance,
    </p>

    <div class="code">
        $ locate bin
    </div>

    <p>
        prints all files whose pathname includes
        the string "bin", so that
    </p>

    <div class="code">
        /var/lib/dpkg/info/texlive-<strong>bin</strong>aries.postinst
    </div>

    <p>
        will be printed, as will
    </p>

    <div class="code">
        /var/lib/gems/2.5.0/<strong>bin</strong>
    </div>

    <p>
        and
    </p>

    <div class="code">
        /var/lib/gems/2.5.0/<strong>bin</strong>/rdoc
    </div>

    <p>
      This will match hidden files, as well.
    </p>

	  <p>
  	    A minor detail:
  	  <em>locate</em> references a database of information about files
      on the system, and not the directories themselves.
      This makes it much faster for ordinary searches.
      If you're looking for new files,
      then you're going to want to update this
      database with:
    </p>

    <div class="code">
        $ sudo updatedb
    </div>

    <p>
        Upon installation of the findutils package, the above command
        is executed for you daily.
    </p>

    <h3>See Also:</h3>
    <ul>
      <li><a href="https://jvns.ca/blog/2015/03/05/how-the-locate-command-works-and-lets-rewrite-it-in-one-minute/"> How the locate command works and let's write a faster version in one minute!</a> (Shoutout to <a href="https://wiki.archlinux.org/index.php/Mlocate">ArchWiki</a> for this link!)</li>
    </ul>

</div>

<div id="find" class="content">

    <h2> Find </h2>
    <p>
        The <a href="http://man7.org/linux/man-pages/man1/find.1.html"><code>find</code></a> utility is much more powerful.
        It searches the directory tree itself, and allows the user
        to query attributes of files besides their names.
    </p>

	    <div class="code">
	        find [starting-point...] [expression]
	    </div>

    <p>
        The <code>find</code> utility works by beginning at the starting point(s)
        specified, inspecting the attributes of each file found there
		against the tests in <code>[expression]</code>.
        If no starting point is specified, then <code>.</code> is implied.
		If the tests pass, then the action stipulated is carried out.
        <code>find</code> then descends into each directory and repeats.
    </p>

	<p>
		The given expression is evaluated left-to-right, and a file is no longer inspected
		once it is known to either pass or fail.
        If the tests in <code>[expression]</code> evaluate to true, then
		<code>find</code> will carry out the action(s) specified;
        if no action is specified, then <code>-print</code> is implied.
    </p>

    <p>
        For instance, we can count all files on the system by,
    </p>

    <div class="code">
        $ sudo find / | wc -l
    </div>

    <p>
        We find 4.1 million files.
    </p>

    <p>
        <code>find</code> supports many tests.
		For instance, to find all
        files of size less-than 4 kilobytes, we could run,
    </p>

	<div class="aside-right">
		<h4>Aside</h4>
		<p>
	        We require superuser privileges to carry out this search because
	        some directories are not searchable by ordinary users.  This
			is determined by the "search bit", which is the "executable" bit of a directory).
		</p>
	</div>

    <div class="code">
        $ sudo find / -size -4k | wc -l<br>
        2746999
    </div>

    <p>
		where <code>-4k</code> means "less than 4 kilobytes."
        Further, to count all executable files with size less than 4 kilobytes, we might,
    </p>

    <div class="code">
        $ sudo find / -size -4k -executable | wc -l
    </div>

    <p>
        This reads as, "Beginning at the root directory, print the pathname of each
        file that is both less than four kilobytes in size and is executable; then, count the lines."
        Files that will "match" are those that are both less than 4 kilobytes in size, and
        whose executable bit is set.  Note that this  includes searchable directories!
        To narrow our count down to programs, we must also specify that each file be of "regular" type:
    </p>

    <div class="code">
        $ sudo find / -size 4k -executable -type f | wc -l
    </div>

    <p>
        It's very important to think of each query as a sequence of logical tests, because that is how
        <code>find</code> thinks of it:
        The default logical operator between tests is <code>-and</code>, and
		the tests are evaluated left-to-right.
		The operators <code>-or</code> and <code>-not</code> are also supported, along
        with parenthesis to allow grouping, but we won't touch on those.
    </p>

	<p>
		<code>find</code> is a very complicated and powerful program.  It has 17
		actions that it can perform on each file, and even offers
		debugging facilities! This discussion is restricted to printing each
		filename and reducing the number of files printed by repeatedly using
		the implied <code>-and</code> operator.
	</p>

        <p>
            To find all files on the system named "bin" on the system, we could execute,
        </p>

        <div class="code">
            $ sudo find / -name bin
        </div>

		<p>
            To restrict the search to directories alone, we add an appropriate test:
        </p>

        <div class="code">
            $ sudo find / -name bin -type d
        </div>

        <p>
            To restrict the search to files in my home directory, we could carry out,
        </p>

		<div class="code">
			$ find ~ -name bin -type d
		</div>

		<p>
			or
		</p>

        <div class="code">
            $ cd <br>
            $ find -name bin -type d
        </div>

        <p>
            and rely on the defaults.
            To learn yet more about finding files, see
			<a href="http://man7.org/linux/man-pages/man1/find.1.html"><code>man 1 find</code></a> or
            <a href="https://www.gnu.org/software/findutils/manual/find.html"> GNU Findutils Official Documentation</a>.
        </p>
    </div>

    <div id="regex" class="content">
      <h2> Regex </h2>
      <p>
        Regex is fun!  It is, essentially, the
      </p>
    </div>

    <div id="grep" class="content">
        <h2>Egrep</h2>

        <p>
            I'm pretty sure that <code>find</code> will let you test against
            any possible system-level attribute that a file may have.
            To go any deeper, we must look inside each file, and that is what
            <code>egrep</code> will allow us to do.
        </p>

        <div class="code">
            egrep [OPTION...] PATTERNS [FILE...]
        </div>

        <p>
            By default, <code>egrep</code> is simple enough:  It reads each <code>FILE</code>,
            and if a line matches one of <code>PATTERNS</code>, it prints the line.<sup><a href="http://www.man7.org/linux/man-pages/man1/grep.1.html">[3]</a></sup>
			If there's more than one <code>FILE</code>, <code>grep</code> will
			tell you that as well.
			If no <code>FILE</code> is given, then <code>grep</code> filters standard-in.
		</p>

        <p>
            Of note, each <code>PATTERN</code> is regex by default, and
            must either terminate with a newline, or else be explicitly specified by
            using the <code>-e</code> option, as in,
        </p>

        <div class="code">
            $ grep -e hello -e world file1.c file2.c
        </div>

        <p>
            This will print each line in files <code>file1.c</code> or <code>file2.c</code>
            which match either <em>hello</em> or <em>world</em> or both.
        </p>

        <p>
            Of <code>grep's</code> options, we are particularly interested in
            <code>-l</code> "list", <code>-C</code> "context", and <code>-r</code> "recurse".
            The <code>-r</code> option specifies that, if a file is a directory,
            recursively descend into it, and search all files in it.
            So,
        </p>

        <div class="code">
            $ grep . -r -e hello -e world
        </div>

        <p>
            will print all lines matching either <em>hello</em> or <em>world</em>
            found in any of the files of the current directory, downwards.
			This can be handy for, for instance, locating all C source files that
			make use of some macro:
		</p>

		<div class="code">
			$ grep . -r -e "MACRO"
		</div>

		<p>
			We can also print the context within which a matched line occurs:
        </p>

        <div class="code">
            $ grep . -r -C 3 -e "MACRO"
        </div>

        <p>
            This will print three lines before, as well as five lines after, each match.
            Finally, to print out just the name of the file, we specify that
            <code>grep</code> list the match, with <code>-l</code>.  This
			could be used to locate the file that defines the macro:
        </p>

        <div class="code">
            $ grep . -rl -e "#define +MACRO"
        </div>

	<h3>See Also:</h3>
		<ul>
			<li><a href="https://github.com/ziishaned/learn-regex">Learn Regex The Easy Way</a></li>
			<li><a href="https://www.youtube.com/watch?v=bgBWp9EIlMM&">Regular Expressions - Enough to be Dangerous</a> (Youtube Video by Engineer Man)</li>
		</ul>

	</div>

    <div id="engineer-man" class="content">
        <h2> Engineer Man </h2>

        <iframe class="video" src="https://www.youtube.com/embed/bgBWp9EIlMM" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>


    </div>

    <div id="references" class="content">
        <h2> References </h2>
        <ol>
            <li><code><a href="http://www.man7.org/linux/man-pages/man1/locate.1.html"> man 1 locate</a></code></li>
			      <li><code><a href="http://man7.org/linux/man-pages/man1/find.1.html">man 1 find</a></code></li>
            <li><code><a href="http://www.man7.org/linux/man-pages/man1/grep.1.html">man 1 grep</a></code></li>
            <li><a href="https://www.gnu.org/software/findutils/manual/find.html"> GNU Findutils Official Documentation</a></li>
            <li><code><a href="http://man7.org/linux/man-pages/man7/regex.7.html"> man 7 regex </a></code></li>
        </ol>

    </div>
